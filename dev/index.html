<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · LagrangianDescriptors.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://github.com/JuliaDynamics/LagrangianDescriptors.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>LagrangianDescriptors.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Overview</a><ul class="internal"><li><a class="tocitem" href="#About"><span>About</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Method"><span>Method</span></a></li><li><a class="tocitem" href="#Approach"><span>Approach</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Current-state"><span>Current state</span></a></li><li><a class="tocitem" href="#Roadmap"><span>Roadmap</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li><li><a class="tocitem" href="#Developers"><span>Developers</span></a></li><li><a class="tocitem" href="#Cite"><span>Cite</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="tutorial_ODEs/">ODEs</a></li><li><a class="tocitem" href="tutorial_RODEs/">RODEs</a></li><li><a class="tocitem" href="postprocessing/">Alternative via post-processing</a></li></ul></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overview</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/LagrangianDescriptors.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="LagrangianDescriptors.jl-documentation"><a class="docs-heading-anchor" href="#LagrangianDescriptors.jl-documentation">LagrangianDescriptors.jl documentation</a><a id="LagrangianDescriptors.jl-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#LagrangianDescriptors.jl-documentation" title="Permalink"></a></h1><p>Painting the phase portrait of deterministic and stochastic systems.</p><p><img src="img/LagrangianDescriptors_socialpreview.png" alt="Social preview"/></p><h2 id="About"><a class="docs-heading-anchor" href="#About">About</a><a id="About-1"></a><a class="docs-heading-anchor-permalink" href="#About" title="Permalink"></a></h2><p>The dynamics of evolutionary systems can be quite intricate. The method of <strong>Lagrangian Descriptors</strong> helps to visualize the complicate behavior of such systems and make sense of it. In a recent article, Wiggins and and García-Garrido call it [a method for] <em>painting the phase portrait</em> (of a dynamical system) (see <a href="https://www.ams.org/journals/notices/202206/noti2489/noti2489.html?adat=June/July%202022&amp;trk=2489&amp;galt=none&amp;cat=feature&amp;pdfissue=202206&amp;pdffile=rnoti-p936.pdf">S. Wiggins and V. J. García-Garrido, Painting the Phase Portrait of a Dynamical System with the Computational Tool of Lagrangian Descriptors (AMS Notices, June/July 2022)</a>.</p><p>The image above, for instance, shows the dynamics of a periodically-forced Duffing equation, with a particular combination of parameters and near time <span>$t=0$</span>.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>Here is the code that generates the background of the image above, displaying some dynamic features of the Duffing equation.</p><pre><code class="language-julia hljs">using OrdinaryDiffEq, Plots
using LinearAlgebra: norm
using LagrangianDescriptors

function f!(du, u, p, t)
    x, y = u
    A, ω = p
    du[1] = y
    du[2] = x - x^3 + A * sin(ω * t)
end

u0 = [0.5, 2.2]
tspan = (0.0, 13.0)
A = 5.0; ω = 2π; p = (A, ω);
prob = ODEProblem(f!, u0, tspan, p)

M(du, u, p, t) = norm(du)
uu0 = [[x, y] for y in range(-1.5, -0.5, length=301), x in range(-0.4, 1.6, length=601)]
lagprob = LagrangianDescriptorProblem(prob, M, uu0)

lagsol = solve(lagprob, Tsit5())</code></pre><h2 id="Method"><a class="docs-heading-anchor" href="#Method">Method</a><a id="Method-1"></a><a class="docs-heading-anchor-permalink" href="#Method" title="Permalink"></a></h2><p>The method is akin to droping colored ink in a fluid flow, tracking the dye as it is transported by the flow, and revealing the pattern created after a certain period of time. The difference being that the color doesn&#39;t get diffused as in a real fluid, so the image doesn&#39;t get blurred and one gets a clearer picture.</p><p>It is similar to drawing a phase portrait, which displays a collection of orbits, but in this method each orbit is painted according to its dynamic behavior, better revealing the overall picture.</p><p>This &quot;coloring&quot; is obtained by integrating a <strong>local,</strong> or <strong>infinitesimal descriptor</strong> <span>$M=M(t, u)$</span> along a solution <span>$u=u(t)$</span> of the system. One common choice for the infinitesimal descriptor is the velocity of the trajectory, so that, upon integration along the solution over a given period of time, the Lagrangian descriptor becomes the arc-length of that portion of the solution. Depending on whether the solution is at a fixed point, or belongs to a stable or unstable manifold, and so on, the arc-length would be closer for solutions with similar behavior, revealing the common patterns of the dynamics.</p><p>Thus, if <span>$u=u(t)$</span> is a solution over a time span <span>$(t_0, t_f)$</span>, with <span>$t_f &gt; t_0$</span>, then the <strong>forward Lagrangian descriptor</strong> is given by</p><p class="math-container">\[L_{\mathrm{fwd}} = \int_{t_0}^{t_f} M(t, u(t)) \;\mathrm{d}t.\]</p><p>If <span>$t_f &lt; t_0$</span>, so that <span>$u=u(t)$</span> is a &quot;backward&quot; solution from <span>$t_0$</span>, then we obtain the <strong>backward Lagrangian descriptor</strong></p><p class="math-container">\[L_{\mathrm{bwd}} = \int_{t_f}^{t_0} M(t, u(t)) \;\mathrm{d}t = - \int_{t_0}^{t_f} M(t, u(t)) \;\mathrm{d}t.\]</p><p>Since the system might be non-autonomous, these Lagragians descriptors are referred as descriptors <strong>near <span>$t_0$</span></strong>.</p><h2 id="Approach"><a class="docs-heading-anchor" href="#Approach">Approach</a><a id="Approach-1"></a><a class="docs-heading-anchor-permalink" href="#Approach" title="Permalink"></a></h2><p>Notice the computation of the Lagrangian descriptors only depend on a given solution and on the infinitesimal descriptor, so that they can be computed <em>a posteriori</em>. However, this is not the most efficient way of computing them. For a more efficient implementation, one writes the integrals for the Lagrangian descriptors as differential equations, i.e.</p><p class="math-container">\[\frac{\mathrm{d}L_{\mathrm{fwd}}}{\mathrm{d}t} = M(t, u(t))\]</p><p>and similarly for the backward Lagrangian descriptor. Then, one solves the (partially) coupled system to obtain the integrated descriptor.</p><p>More explicitly, when both forward and backward Lagrangians are desired, we may write a four-component system for solving both the backward and forward solutions and the backward and forward Lagrangians at the same time:</p><p class="math-container">\[\begin{cases}
  \displaystyle \frac{\mathrm{d}u}{\mathrm{d}t} = f(u, t), \\ \\
  \displaystyle \frac{\mathrm{d}v}{\mathrm{d}t} = -f(v, 2t_0 - t), \\ \\
  \displaystyle \frac{\mathrm{d}L_{\mathrm{fwd}}}{\mathrm{d}t} = M(u, t), \\ \\
  \displaystyle \frac{\mathrm{d}L_{\mathrm{bwd}}}{\mathrm{d}t} = M(v, 2t_0 - t),
\end{cases}\]</p><p>with the set of initial conditions</p><p class="math-container">\[u(t_0) = v(t_0) = u_0, \quad L_{\mathrm{fwd}}(t_0) = L_{\mathrm{bwd}}(t_0) = 0.\]</p><p>For a given time interval <span>$(t_0, t_f)$</span>, with <span>$t_f &gt; t_0$</span>, notice that <span>$u=u(t)$</span> solves the system forward, over the interval <span>$(t_0, t_f)$</span>, while <span>$v=v(t)$</span> is defined over <span>$(t_0, t_f)$</span> but corresponds to solving the system backward, starting at <code>t_0</code> and ending at <span>$2t_0 - t_f = t_0 - (t_f - t_0)$</span>, both with the same initial condition <span>$u_0$</span>, i.e. the augmented system computes the forward and backward parts of the same trajectory, over the same length of time, but in different directions.</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The API is simple, it amounts to i) building a <code>LagrangianDescriptorProblem</code>, ii) solving it with an overload of <code>solve</code>; and iii) plotting the solution with a <code>plot</code> recipe:</p><pre><code class="language-julia hljs">lagprob = LagrangianDescriptorProblem(prob, M, uu0)
lagsol = solve(lagprob, alg)
plot(lagsol)</code></pre><p>where <code>prob</code> is a given problem, such as an <code>ODEProblem</code>; <code>M</code> is the infinitesimal Lagrangian descriptor; <code>uu0</code> is a collection of initial conditions; and <code>alg</code> is the algorithm chosen to solve <code>prob</code>, such as <code>Tsit5()</code>.</p><p>More precisely, the implementation works as follows:</p><ol><li>One builds a <em>differential equation problem</em> <code>prob</code> of a type defined in <code>SciMLBase.jl</code>, from <a href="https://github.com/SciML/DifferentialEquations.jl">SciML/DifferentialEquations.jl</a>, say an <code>ODEProblem</code> for <span>$\mathrm{d}u/\mathrm{d}t = f(u, p, t)$</span> (in-place or out-of-place). </li><li>One chooses an <em>infinitesimal descriptor</em> of the form <code>M=M(du, u, p, t)</code> (or other form suitable to the given problem type), with scalar values, that will be integrated along a solution <span>$u(t) = u(t; u_0)$</span>, to yield the forward Lagrangian descriptor <span>$L_{\mathrm{fwd}}(u_0)$</span> and the backward Lagrangian descriptor <span>$L_{\mathrm{bwd}}(u_0)$</span>, for a given initial condition <span>$u_0$</span>.</li><li>One chooses a collection <code>uu0</code> of initial conditions (e.g. a <code>Vector</code>, or a more general <code>Array</code> or any iterator, with the elements of the collection being suitable initial conditions for the given problem), representing a mesh in phase space or a portion of a sub-manifold of the phase space to be &quot;painted&quot; by the method.</li><li>Then we pass them to <code>lagprob = LagrangianDescriptorProblem(prob, M, uu0)</code>, to create the associated <em>Lagrangian descriptor problem</em> <code>lagprob</code>.<ol><li><code>LagrangianDescriptorProblem</code> uses <code>prob.f</code>, <code>prob.p</code>, <code>prob.u0</code>, <code>prob.tspan</code>, and any <code>prob.kwargs</code> to create, via <code>ComponentArrays</code>, a new problem (e.g. a new <code>ODEProblem</code>) for the <em>augmented system</em>.</li><li>The <em>augmented</em> problem has, by default, four components, for solving the original equation forward and backward in time, and for solving the Lagrangian descriptors forward and backward in time. The way the augmented systems is constructed is via <a href="https://github.com/jonniedie/ComponentArrays.jl">ComponentArrays.jl</a>, so the augmented system is a <code>ComponentVector</code>, with components <code>fwd</code>, <code>bwd</code>, <code>lfwd</code>, and <code>lbwd</code>, respectively.</li><li>One may choose the keyword <code>direction = :forward</code> or <code>direction = :backward</code> to build the augmented system in only one direction, with the default being <code>direction = :both</code>.</li><li><code>LagrangianDescriptorProblem</code> then wraps an <a href="https://diffeq.sciml.ai/dev/features/ensemble/">EnsembleProblem</a> for the augmented system and with the given collection <code>uu_0</code> of initial conditions to be used at each trajectory of the ensemble;</li></ol></li><li>Solve the <code>LagrangianDescriptorProblem</code> by invoking <code>lagsol = solve(lagprob, alg, args..., kwargs...)</code>, with the appropriate algorithm and any other argument for the ensemble solve of the underlying ensemble problem <code>lagprob.ensprob</code>. </li><li><code>solve</code> returns a <code>LagrangianDescriptorSolution</code> containing the associated collection of (forward and backward) Lagrangian descriptor values at the final time of each simulation (which is <span>$t_f$</span> for the forward components and corresponds to <span>$2t_0 - t_f$</span> for the backward ones). This solution has the following fields:<ol><li><code>enssol</code>: the <code>EnsembleSolution</code> of the associated ensemble problem, where <code>enssol.u</code> contains a vector with the component arays <code>lfwd</code> and <code>lbwd</code> (or only one of them, depending on the <code>direction</code>) for the Lagrangian descriptors at the final time of the simulation (i.e. <span>$t_f$</span> for the forward Lagrangian and <span>$2t_0 - t_f$</span> for the backward);</li><li><code>uu0</code>: the given collection of initial conditions;</li><li><code>direction</code>: the direction chosen, which defaults to <code>:both</code>, but can be also <code>:forward</code> or <code>:backward</code>.</li></ol></li><li>Finally, one can use <code>plot</code> to visualize either the forward, or the backward, or the sum (total), or even the difference, of the forward and backward Lagrangian descriptor, via a plot recipe for the <code>LagrangianDescriptorSolution</code>, i.e. by calling <code>plot(lagsol)</code> or <code>plot(lagsol, direction)</code>, where <code>direction</code> is either <code>:forward</code>, <code>:backward</code>, <code>:total</code> or <code>:difference</code>.</li></ol><h2 id="Current-state"><a class="docs-heading-anchor" href="#Current-state">Current state</a><a id="Current-state-1"></a><a class="docs-heading-anchor-permalink" href="#Current-state" title="Permalink"></a></h2><p>The package is still in an embrionary phase and currently accepts differential equations of the type <code>ODEProblem</code> and <code>RODEProblem</code>. Problems of the type <code>SDEProblem</code> will be implemented soon. Other problems will come eventually.</p><p>The plot recipe works for some types of collections of initial conditions (e.g. a <code>AbstractVector{&lt;:Number}</code>, for scalar problems, and <code>AbstractMatrix{&lt;:AbstractVector{&lt;:Number}}</code> with the <code>AbstractVector</code> of length two, for two-dimensional problems). More general and flexible plot recipes will also be implemented.</p><h2 id="Roadmap"><a class="docs-heading-anchor" href="#Roadmap">Roadmap</a><a id="Roadmap-1"></a><a class="docs-heading-anchor-permalink" href="#Roadmap" title="Permalink"></a></h2><p>What is currently missing:</p><ol><li>Support for other types of problems, such as <code>SDEProblem</code>, mixed differential-algebraic equations, etc.;</li><li>A more flexible plot recipe;</li><li>Improve the documentation with more examples;</li><li>Maybe an adaptive method to refine the set <code>uu0</code> of initial conditions!;</li><li>I don&#39;t know whether/how the idea applies to delay type equations, but we should check that out.</li><li>Register the package.</li></ol><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li><a href="https://www.ams.org/journals/notices/202206/noti2489/noti2489.html?adat=June/July%202022&amp;trk=2489&amp;galt=none&amp;cat=feature&amp;pdfissue=202206&amp;pdffile=rnoti-p936.pdf">Painting the Phase Portrait of a Dynamical System with the Computational Tool of Lagrangian Descriptors</a></li><li><a href="https://www.sciencedirect.com/science/article/abs/pii/S1007570413002037">Lagrangian descriptors: A method for revealing phase space structures of general time dependent dynamical systems</a></li><li><a href="https://champsproject.github.io/lagrangian_descriptors/docs/authors.html">Lagrangian Descriptors - <em>Discovery and Quantification of Phase Space Structure and Transport</em></a></li><li><a href="https://acp.copernicus.org/preprints/acp-2016-633/acp-2016-633-SC2-supplement.pdf">Frequently Asked Questions about Lagrangian Descriptors</a></li></ul><h2 id="Developers"><a class="docs-heading-anchor" href="#Developers">Developers</a><a id="Developers-1"></a><a class="docs-heading-anchor-permalink" href="#Developers" title="Permalink"></a></h2><p><a href="https://github.com/JuliaDynamics/LagrangianDescriptors.jl">JuliaDynamics/LagrangianDescriptors.jl</a> is currently being developed by <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>, but contributors are welcome.</p><h2 id="Cite"><a class="docs-heading-anchor" href="#Cite">Cite</a><a id="Cite-1"></a><a class="docs-heading-anchor-permalink" href="#Cite" title="Permalink"></a></h2><p>Just cite the github repo <a href="https://github.com/JuliaDynamics/LagrangianDescriptors.jl">JuliaDynamics/LagrangianDescriptors.jl</a> for now, while the package is not yet registered.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorial_ODEs/">ODEs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 30 September 2022 00:05">Friday 30 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
